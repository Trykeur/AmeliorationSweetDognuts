/*----------------------------------------------------------------------------------------------------
----------------------------------------- INSERT _CLIENT ---------------------------------------------
----------------------------------------------------------------------------------------------------*/

insert into Client_ (email, pwd, profil_name) values ('frignall1@utexas.edu', 'xD6}qE2U5~.J', 'Forester');
insert into Client_ (email, pwd, profil_name) values ('hnorcott2@sphinn.com', 'nR7''W\arTj.QXr9', 'Herschel');
insert into Client_ (email, pwd, profil_name) values ('brignall3@flickr.com', 'nV0\tOi\', 'Bancroft');
insert into Client_ (email, pwd, profil_name) values ('gboij4@archive.org', 'tB7/x7/xsu0>O,', 'Gerhard');
insert into Client_ (email, pwd, profil_name) values ('tbeaford5@woothemes.com', 'zE0)R.<Ns~q', 'Towny');
insert into Client_ (email, pwd, profil_name) values ('lgeorger6@salon.com', 'aW5\g~Zw/L79lT', 'Levin');
insert into Client_ (email, pwd, profil_name) values ('gbreming7@sourceforge.net', 'kV2/>!{+V9pD', 'Glenden');
insert into Client_ (email, pwd, profil_name) values ('dlate8@forbes.com', 'xQ2|%hI.', 'Darby');
insert into Client_ (email, pwd, profil_name) values ('nphilipot9@flavors.me', 'hI7{Mf55.6R', 'Noland');
insert into Client_ (email, pwd, profil_name) values ('agaukrogera@amazonaws.com', 'tT5>fEjEzjOK', 'Aldon');
insert into Client_ (email, pwd, profil_name) values ('skirkhamb@g.co', 'fH1\//H!Z0pKnG', 'Sherman');
insert into Client_ (email, pwd, profil_name) values ('abanfordc@miitbeian.gov.cn', 'dR8<?T<v9zC<a', 'Arni');
insert into Client_ (email, pwd, profil_name) values ('upichefordd@mozilla.org', 'gX2$aH8Q_\,l', 'Ulberto');
insert into Client_ (email, pwd, profil_name) values ('aguthrume@newsvine.com', 'bY7?\@X%o\fLXb`', 'Arni');
insert into Client_ (email, pwd, profil_name) values ('swarrilowf@naver.com', 'pI6#ebip8', 'Stillman');
insert into Client_ (email, pwd, profil_name) values ('bglassardg@yale.edu', 'aO8}%{LaEJD$', 'Baxie');
insert into Client_ (email, pwd, profil_name) values ('cmuehleh@tripadvisor.com', 'kQ1}>zOPf', 'Cullen');
insert into Client_ (email, pwd, profil_name) values ('cpageti@hostgator.com', 'pW2>82,Px''''K', 'Conant');
insert into Client_ (email, pwd, profil_name) values ('ainglej@parallels.com', 'rG6#o5aklOlF}', 'Abba');
insert into Client_ (email, pwd, profil_name) values ('moldershawk@harvard.edu', 'rE8}(I@uA$dY5', 'Marion');
insert into Client_ (email, pwd, profil_name) values ('gcurrelll@csmonitor.com', 'eY5.G4|"8g%4', 'Garfield');
insert into Client_ (email, pwd, profil_name) values ('rpridiem@phpbb.com', 'fK0)Ue!}I6', 'Rolland');
insert into Client_ (email, pwd, profil_name) values ('shartzogsn@netlog.com', 'mW3|QiYE*V@#', 'Saundra');
insert into Client_ (email, pwd, profil_name) values ('gpanimano@istockphoto.com', 'uI7\VuXTd1gIQ\X', 'Gram');
insert into Client_ (email, pwd, profil_name) values ('rprobeyp@earthlink.net', 'oG3}WbVc"9(', 'Raleigh');
insert into Client_ (email, pwd, profil_name) values ('jbillionq@jimdo.com', 'oE7''CPr0##(K*9#', 'Jack');
insert into Client_ (email, pwd, profil_name) values ('esquirer@webs.com', 'qR7?FtOmS0', 'Ewan');
insert into Client_ (email, pwd, profil_name) values ('jrugges@reuters.com', 'vU5.a''`#{Y', 'Jocko');
insert into Client_ (email, pwd, profil_name) values ('cnajafiant@tmall.com', 'lF0>Nd*(', 'Clemmie');
insert into Client_ (email, pwd, profil_name) values ('emedlaru@bbb.org', 'qC5<O4?VL.U', 'Eberto');
insert into Client_ (email, pwd, profil_name) values ('aelmerv@xinhuanet.com', 'fM6{OrYrrGYd#F0', 'Aluino');
insert into Client_ (email, pwd, profil_name) values ('dpotburyw@miibeian.gov.cn', 'eO9(HN(Uwo*?', 'Dunc');
insert into Client_ (email, pwd, profil_name) values ('tferraracciox@pinterest.com', 'jW7,qV8''>vLy', 'Timmy');
insert into Client_ (email, pwd, profil_name) values ('kdudneyy@phpbb.com', 'yN4)As0N8wQ''QhR', 'Kimble');
insert into Client_ (email, pwd, profil_name) values ('ogallonz@apple.com', 'nN8!VLUGF', 'Olvan');
insert into Client_ (email, pwd, profil_name) values ('bmistry10@baidu.com', 'gF8.ZOnC/iI8*C=r', 'Bordy');
insert into Client_ (email, pwd, profil_name) values ('shustings11@spiegel.de', 'lZ3`v<deoOV', 'Salomon');
insert into Client_ (email, pwd, profil_name) values ('gsnare12@china.com.cn', 'aG6~1%JGwu,6V\dI', 'Germaine');
insert into Client_ (email, pwd, profil_name) values ('lbezley13@macromedia.com', 'aD2?5!RN', 'Levey');
insert into Client_ (email, pwd, profil_name) values ('akinforth14@technorati.com', 'pJ7>0,=6', 'Alexander');
insert into Client_ (email, pwd, profil_name) values ('wlyston15@berkeley.edu', 'cD0@Zv(hhy?7G8', 'Westley');
insert into Client_ (email, pwd, profil_name) values ('acrone16@hubpages.com', 'oT9(r9&"pI+', 'Alwyn');
insert into Client_ (email, pwd, profil_name) values ('mvardey17@elegantthemes.com', 'bD3.ZCG?LY''XY', 'Merrill');
insert into Client_ (email, pwd, profil_name) values ('hwilstead18@tamu.edu', 'sW9&<tw1EkI!', 'Hermann');
insert into Client_ (email, pwd, profil_name) values ('abrunsdon19@flickr.com', 'pB1%Hv{%V', 'Aubrey');
insert into Client_ (email, pwd, profil_name) values ('hmayfield1a@nydailynews.com', 'bL0{2P1v))}3', 'Hayden');
insert into Client_ (email, pwd, profil_name) values ('syurkevich1b@army.mil', 'jU4$iO0''lZwJo', 'Skelly');
insert into Client_ (email, pwd, profil_name) values ('wscotson1c@nih.gov', 'sA1!AVG}OM5~(.le', 'Wald');
insert into Client_ (email, pwd, profil_name) values ('ssirman1d@fotki.com', 'hB2~dd4__dIrET', 'Sylvester');
insert into Client_ (email, pwd, profil_name) values ('lsickling1e@google.nl', 'uX1+H0kUQ@v0T', 'Levon');
insert into Client_ (email, pwd, profil_name) values ('jrudsdell1f@taobao.com', 'zZ1{TVpQ{?MI=H7', 'Jeramie');
insert into Client_ (email, pwd, profil_name) values ('hthrelfall1g@twitter.com', 'yG5<Y*gSZ~', 'Hobard');
insert into Client_ (email, pwd, profil_name) values ('gravel1h@msn.com', 'eX7<K#EDL$?''m2k3', 'Guillermo');
insert into Client_ (email, pwd, profil_name) values ('rmacarthur1i@goo.gl', 'dW0?iYI)', 'Robinson');
insert into Client_ (email, pwd, profil_name) values ('breaveley1j@symantec.com', 'uW7%FZ4V', 'Bret');
insert into Client_ (email, pwd, profil_name) values ('lkarlik1k@ft.com', 'hC1=8_~qsK(bnBx', 'Lester');
insert into Client_ (email, pwd, profil_name) values ('apriddle1l@newyorker.com', 'fT0{C%_,d{686', 'Archibaldo');
insert into Client_ (email, pwd, profil_name) values ('wtroak1m@delicious.com', 'qZ1.!vO"U&vKD', 'Win');
insert into Client_ (email, pwd, profil_name) values ('bmaffia1n@so-net.ne.jp', 'rD3`WPav', 'Brig');
insert into Client_ (email, pwd, profil_name) values ('gbraniff1o@t.co', 'rB0+G_IzOvrd', 'Gerald');
insert into Client_ (email, pwd, profil_name) values ('jberrie1p@usatoday.com', 'eK6`<@XvFIp', 'Job');
insert into Client_ (email, pwd, profil_name) values ('ppairpoint1q@list-manage.com', 'wT5*@LQn=r', 'Poul');
insert into Client_ (email, pwd, profil_name) values ('cmatelaitis1r@icq.com', 'jX4{9NpSrC)`', 'Chilton');
insert into Client_ (email, pwd, profil_name) values ('ogarces1s@unc.edu', 'bE5*!e(OZ', 'Ossie');
insert into Client_ (email, pwd, profil_name) values ('rebenezer1t@csmonitor.com', 'kI6`6/8Pv/+=', 'Ric');
insert into Client_ (email, pwd, profil_name) values ('hroadnight1u@yolasite.com', 'mE0\+3(uRv&fpQs', 'Herculie');
insert into Client_ (email, pwd, profil_name) values ('erobb1v@privacy.gov.au', 'aZ2&Ltkd*3=e%', 'Edd');
insert into Client_ (email, pwd, profil_name) values ('aaylin1w@hostgator.com', 'oF6''g3=eQ@', 'Ave');
insert into Client_ (email, pwd, profil_name) values ('oproudman1x@posterous.com', 'dG0,!VqhLuO', 'Oliver');
insert into Client_ (email, pwd, profil_name) values ('gconerding1y@dmoz.org', 'mX1|q}"hJ7', 'Geno');
insert into Client_ (email, pwd, profil_name) values ('dhurn1z@nih.gov', 'cF0.3fInZ*(', 'Darn');
insert into Client_ (email, pwd, profil_name) values ('dhazelgrove20@g.co', 'rW7>mFpO~t', 'Devlen');
insert into Client_ (email, pwd, profil_name) values ('rcallaby21@adobe.com', 'nK4''TVI@YAM', 'Reece');
insert into Client_ (email, pwd, profil_name) values ('cstrippel22@creativecommons.org', 'jH5!8b>0}5', 'Charles');
insert into Client_ (email, pwd, profil_name) values ('kingamells23@trellian.com', 'hQ6#D''n3E07d7?kL', 'Kile');
insert into Client_ (email, pwd, profil_name) values ('jodell24@utexas.edu', 'xU7=w=\b', 'Jermaine');
insert into Client_ (email, pwd, profil_name) values ('nmannock25@dmoz.org', 'rB0!Qy=AxPdb', 'Nick');
insert into Client_ (email, pwd, profil_name) values ('dpuden26@google.it', 'hM7>_\Ulq\0H', 'Darill');
insert into Client_ (email, pwd, profil_name) values ('rmarzelle27@infoseek.co.jp', 'nC0.&#~*IV', 'Royal');
insert into Client_ (email, pwd, profil_name) values ('wburdytt28@umich.edu', 'oH0"Qk,)j|', 'Winslow');
insert into Client_ (email, pwd, profil_name) values ('nshearman29@fema.gov', 'pZ9+,FlTc(J', 'Nicola');
insert into Client_ (email, pwd, profil_name) values ('hrestill2a@webnode.com', 'yL7{dz\$', 'Hunt');
insert into Client_ (email, pwd, profil_name) values ('fantoniou2b@howstuffworks.com', 'sZ2~nG|''{C{i2Ph,', 'Faulkner');
insert into Client_ (email, pwd, profil_name) values ('jmacclancey2c@biblegateway.com', 'kV9{Hlb9,0', 'Joel');
insert into Client_ (email, pwd, profil_name) values ('dduckerin2d@imgur.com', 'uK1"HZFJ`6xE?', 'Delmar');
insert into Client_ (email, pwd, profil_name) values ('pdelafont2e@networkadvertising.org', 'zG8/|~toAeEy', 'Pincas');
insert into Client_ (email, pwd, profil_name) values ('ntarling2f@si.edu', 'yC6~lO{2', 'Nevin');
insert into Client_ (email, pwd, profil_name) values ('cyewman2g@dyndns.org', 'gN0''E2cZq0`EW8sS', 'Connor');
insert into Client_ (email, pwd, profil_name) values ('abyres2h@quantcast.com', 'lY4=FPSqR)', 'Alisander');
insert into Client_ (email, pwd, profil_name) values ('fberrane2i@elpais.com', 'kK1,0`<t5NAST', 'Flint');
insert into Client_ (email, pwd, profil_name) values ('averheyden2j@stumbleupon.com', 'tT0$8"?B<Rmc', 'Andrus');
insert into Client_ (email, pwd, profil_name) values ('ewoolam2k@merriam-webster.com', 'jT6=I%tM>4?SwCF', 'Errol');
insert into Client_ (email, pwd, profil_name) values ('hbergstrand2l@omniture.com', 'nC5''YCmz2ULN', 'Hirsch');
insert into Client_ (email, pwd, profil_name) values ('abosket2m@privacy.gov.au', 'tB1,Ak2"TK5}==OT', 'Artus');
insert into Client_ (email, pwd, profil_name) values ('crazzell2n@who.int', 'oG9_v."E~V', 'Clayton');
insert into Client_ (email, pwd, profil_name) values ('swincom2o@deliciousdays.com', 'gC8''VrV2.s~', 'Stewart');
insert into Client_ (email, pwd, profil_name) values ('rgowdy2p@jalbum.net', 'nE4|2IUEX@{9p', 'Reilly');
insert into Client_ (email, pwd, profil_name) values ('gtrasler2q@home.pl', 'kZ3}E)MMQjK', 'Gay');
insert into Client_ (email, pwd, profil_name) values ('wlarmuth2r@freewebs.com', 'sL4?vC6n6A&vTdG', 'Wolfy');

/*----------------------------------------------------------------------------------------------------
------------------------------------- _PROFIL_OEUVRE RANDOM ------------------------------------------
----------------------------------------------------------------------------------------------------*/
DELETE FROM _Profil_Oeuvre;

DO 
$do$
DECLARE
	random_id_genre1 INTEGER;
	random_id_genre2 INTEGER;
	random_id_genre3 INTEGER;
	NB_MOVIE integer DEFAULT 10;
	random_number_1 integer;
	random_number_2 integer;
	number_3 integer;
	rec RECORD;
BEGIN
	FOR rec in (SELECT _Profil.id_profil FROM _Profil) LOOP
		random_number_1 := (FLOOR(RANDOM()*(NB_MOVIE))+1);
		random_number_2 := (FLOOR(RANDOM()*(NB_MOVIE-random_number_1)));
		number_3 := NB_MOVIE-random_number_1-random_number_2;
		
		SELECT id_genre INTO random_id_genre1 FROM _genre ORDER BY RANDOM() LIMIT 1;
		SELECT id_genre INTO random_id_genre2 FROM _genre WHERE id_genre != random_id_genre1 ORDER BY RANDOM() LIMIT 1;
		SELECT id_genre INTO random_id_genre3 FROM _genre WHERE id_genre != random_id_genre1 AND id_genre != random_id_genre2 ORDER BY RANDOM() LIMIT 1;
		
		INSERT INTO _Profil_Oeuvre(id_profil, id_oeuvre, rating)
		WITH random_movie AS (
			SELECT rec.id_profil,_movie.id_oeuvre FROM _movie
			LEFT JOIN _oeuvre_genre ON _oeuvre_genre.id_oeuvre = _movie.id_oeuvre
				WHERE _oeuvre_genre.id_genre = random_id_genre1
				ORDER BY RANDOM() LIMIT random_number_1)
		SELECT id_profil,id_oeuvre, rating FROM random_movie
		NATURAL JOIN (SELECT id_oeuvre, (ROUND((RANDOM()*(9))::NUMERIC,1)+1) as rating FROM random_movie) as random_rating;

		INSERT INTO _Profil_Oeuvre(id_profil, id_oeuvre, rating)
		WITH random_movie AS (
			SELECT rec.id_profil,_movie.id_oeuvre FROM _movie
			LEFT JOIN _oeuvre_genre ON _oeuvre_genre.id_oeuvre = _movie.id_oeuvre
				WHERE 	_oeuvre_genre.id_genre = random_id_genre2 AND 
						_movie.id_oeuvre NOT IN (SELECT id_oeuvre FROM _Profil_Oeuvre WHERE id_profil = rec.id_profil)
				ORDER BY RANDOM() LIMIT random_number_2)
		SELECT id_profil,id_oeuvre, rating FROM random_movie
		NATURAL JOIN (SELECT id_oeuvre, (ROUND((RANDOM()*(9))::NUMERIC,1)+1) as rating FROM random_movie) as random_rating;

		INSERT INTO _Profil_Oeuvre(id_profil, id_oeuvre, rating)
		WITH random_movie AS (
			SELECT rec.id_profil,_movie.id_oeuvre FROM _movie
			LEFT JOIN _oeuvre_genre ON _oeuvre_genre.id_oeuvre = _movie.id_oeuvre
				WHERE 	_oeuvre_genre.id_genre = random_id_genre3 AND 
						_movie.id_oeuvre NOT IN (SELECT id_oeuvre FROM _Profil_Oeuvre WHERE id_profil = rec.id_profil)
				ORDER BY RANDOM() LIMIT number_3)
		SELECT id_profil,id_oeuvre, rating FROM random_movie
		NATURAL JOIN (SELECT id_oeuvre, (ROUND((RANDOM()*(9))::NUMERIC,1)+1) as rating FROM random_movie) as random_rating;

	END LOOP;
END;
$do$;


/*
INSERT INTO _Profil_Oeuvre VALUES (1,5404683,7);
INSERT INTO _Profil_Oeuvre VALUES (1,869814,6);
INSERT INTO _Profil_Oeuvre VALUES (1,1474410,4);
INSERT INTO _Profil_Oeuvre VALUES (1,5571225,5);
INSERT INTO _Profil_Oeuvre VALUES (1,117791,8);
INSERT INTO _Profil_Oeuvre VALUES (1,156969,3);
INSERT INTO _Profil_Oeuvre VALUES (1,418079,7);
INSERT INTO _Profil_Oeuvre VALUES (1,480092,9);

INSERT INTO _Profil_Oeuvre VALUES (2,119731,7);
INSERT INTO _Profil_Oeuvre VALUES (2,242138,4.5);
INSERT INTO _Profil_Oeuvre VALUES (2,9221603,6.5);
INSERT INTO _Profil_Oeuvre VALUES (2,9862072,5);
INSERT INTO _Profil_Oeuvre VALUES (2,351707,7.2);
INSERT INTO _Profil_Oeuvre VALUES (2,8958049,3.0);
INSERT INTO _Profil_Oeuvre VALUES (2,7776269,9.5);
INSERT INTO _Profil_Oeuvre VALUES (2,266579,8.5);
INSERT INTO _Profil_Oeuvre VALUES (2,407772,9);

INSERT INTO _Profil_Oeuvre VALUES (3,129384,7);
INSERT INTO _Profil_Oeuvre VALUES (3,232440,6.5);
INSERT INTO _Profil_Oeuvre VALUES (3,118686,8);
INSERT INTO _Profil_Oeuvre VALUES (3,6162739,6);
INSERT INTO _Profil_Oeuvre VALUES (3,117964,6);
INSERT INTO _Profil_Oeuvre VALUES (3,6321728,7);
INSERT INTO _Profil_Oeuvre VALUES (3,440079,5);
INSERT INTO _Profil_Oeuvre VALUES (3,821352,8);
INSERT INTO _Profil_Oeuvre VALUES (3,7608518,9);
INSERT INTO _Profil_Oeuvre VALUES (3,117773,5);
INSERT INTO _Profil_Oeuvre VALUES (3,418079,6);
INSERT INTO _Profil_Oeuvre VALUES (3,480092,8.5);
INSERT INTO _Profil_Oeuvre VALUES (3,4345477,8);

INSERT INTO _Profil_Oeuvre VALUES (4,129384,5.5);
INSERT INTO _Profil_Oeuvre VALUES (4,3203616,6.5);
INSERT INTO _Profil_Oeuvre VALUES (4,116826,8);
INSERT INTO _Profil_Oeuvre VALUES (4,117962,7);
INSERT INTO _Profil_Oeuvre VALUES (4,461353,7.5);
INSERT INTO _Profil_Oeuvre VALUES (4,430183,8);
INSERT INTO _Profil_Oeuvre VALUES (4,418079,6);
INSERT INTO _Profil_Oeuvre VALUES (4,6321728,5.5);
INSERT INTO _Profil_Oeuvre VALUES (4,100761,5.5);
INSERT INTO _Profil_Oeuvre VALUES (4,5576346,3);
INSERT INTO _Profil_Oeuvre VALUES (4,480092,5);
*/